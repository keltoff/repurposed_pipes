[gd_scene load_steps=37 format=4 uid="uid://dredt2euhd4sp"]

[ext_resource type="Script" uid="uid://ctrdjlesjen4i" path="res://main_scene.gd" id="1_84odl"]
[ext_resource type="Texture2D" uid="uid://irq2uedvugdh" path="res://img/pipes_rotated.png" id="1_d5x1h"]
[ext_resource type="Texture2D" uid="uid://dwtwaudq33xr0" path="res://img/Gold_Border.png" id="1_gyfs4"]
[ext_resource type="Texture2D" uid="uid://bskfdi5etc0th" path="res://img/background.png" id="2_vimvf"]
[ext_resource type="Texture2D" uid="uid://dm52qgs2a4wdl" path="res://img/pipes_rotated_full.png" id="3_66tet"]
[ext_resource type="Script" uid="uid://craoq4w1o3i31" path="res://tiles.gd" id="4_7ycvg"]
[ext_resource type="Script" uid="uid://cpy82sfmefxmw" path="res://new_block.gd" id="4_nfk4m"]
[ext_resource type="Script" uid="uid://ddylbgh304wo0" path="res://piece_queue.gd" id="6_7ycvg"]
[ext_resource type="Script" uid="uid://dlhd427q6jlxj" path="res://sfx_manager.gd" id="6_nfk4m"]
[ext_resource type="Script" uid="uid://drcvfitehngiy" path="res://timer.gd" id="7_ak604"]
[ext_resource type="AudioStream" uid="uid://benekohdh3h87" path="res://sfx/body hits metal 12.wav" id="8_7ycvg"]
[ext_resource type="AudioStream" uid="uid://cns7s3v5ixx2e" path="res://sfx/bat being held 5.wav" id="9_wr18j"]
[ext_resource type="Texture2D" uid="uid://cqapyygvsiier" path="res://img/plus.png" id="10_ghshe"]
[ext_resource type="Script" uid="uid://boevokyyt7w8w" path="res://music_player.gd" id="10_wr18j"]
[ext_resource type="AudioStream" uid="uid://biqjv6r543dxo" path="res://music/Patreon Challenge 06.ogg" id="11_6jybn"]
[ext_resource type="AudioStream" uid="uid://cpkyk4dyf2yr3" path="res://music/Sketchbook 2024-03-30_01_L02.ogg" id="12_84odl"]
[ext_resource type="AudioStream" uid="uid://b0kpxtwmh6wan" path="res://music/Sketchbook 2025-11-13.ogg" id="13_ak604"]
[ext_resource type="AudioStream" uid="uid://djq0j56kvii0j" path="res://music/Sketchbook 2025-11-12.ogg" id="14_vimvf"]
[ext_resource type="AudioStream" uid="uid://bs7kkliwsdr4n" path="res://music/VGMA Challenge 08.ogg" id="15_ghshe"]
[ext_resource type="AudioStream" uid="uid://bjvp2vkq454kj" path="res://music/Sketchbook 2025-12-14 LOOP.ogg" id="16_fv2he"]
[ext_resource type="AudioStream" uid="uid://2bc4g3jc1hwa" path="res://music/VGMA Challenge 14.ogg" id="17_5smuj"]
[ext_resource type="AudioStream" uid="uid://cfo6b8ypb5d2u" path="res://music/VGMA Challenge 20.ogg" id="18_y5ved"]
[ext_resource type="AudioStream" uid="uid://bj2yjnx8hd0nv" path="res://music/Patreon Challenge 13.ogg" id="19_kv3aw"]

[sub_resource type="TileMapPattern" id="TileMapPattern_gyfs4"]
tile_data = PackedInt32Array(0, 65537, 0, 1, 65537, 0, 2, 65537, 0, 3, 65537, 0)

[sub_resource type="TileMapPattern" id="TileMapPattern_d5x1h"]
tile_data = PackedInt32Array(65536, 65537, 0, 1, 1, 0, 65537, 1, 805306368, 2, 65537, 0)

[sub_resource type="TileMapPattern" id="TileMapPattern_8mm7a"]
tile_data = PackedInt32Array(65536, 65537, 0, 1, 65537, 1610612736, 65537, 131073, 805306368, 65538, 65537, 0)

[sub_resource type="TileMapPattern" id="TileMapPattern_hq1ik"]
tile_data = PackedInt32Array(0, 196609, 0, 65536, 196609, 0, 1, 196609, 0, 65537, 196609, 0)

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_8mm7a"]
resource_name = "Pipes"
texture = ExtResource("1_d5x1h")
texture_region_size = Vector2i(32, 32)
3:0/0 = 0
1:1/0 = 0
2:1/0 = 0
3:1/0 = 0
1:2/0 = 0
2:2/0 = 0
2:2/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, -16, 16, -16, 16, 16, -16, 16)
3:2/0 = 0
0:3/0 = 0
1:3/0 = 0
2:3/0 = 0
3:3/0 = 0

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_wr18j"]
resource_name = "PipesFull"
texture = ExtResource("3_66tet")
texture_region_size = Vector2i(32, 32)
3:0/0 = 0
1:1/0 = 0
2:1/0 = 0
3:1/0 = 0
1:2/0 = 0
2:2/0 = 0
3:2/0 = 0
0:3/0 = 0
1:3/0 = 0
2:3/0 = 0
3:3/0 = 0

[sub_resource type="TileSet" id="TileSet_gyfs4"]
tile_size = Vector2i(32, 32)
physics_layer_0/collision_layer = 1
terrain_set_0/mode = 0
terrain_set_0/terrain_0/name = "Terrain 0"
terrain_set_0/terrain_0/color = Color(0.5, 0.34375, 0.25, 1)
sources/0 = SubResource("TileSetAtlasSource_8mm7a")
sources/1 = SubResource("TileSetAtlasSource_wr18j")
pattern_0 = SubResource("TileMapPattern_gyfs4")
pattern_1 = SubResource("TileMapPattern_d5x1h")
pattern_2 = SubResource("TileMapPattern_8mm7a")
pattern_3 = SubResource("TileMapPattern_hq1ik")

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_fv2he"]
bg_color = Color(0.49803922, 0.14117648, 0.14509805, 1)

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_ghshe"]

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_fv2he"]

[sub_resource type="StyleBoxTexture" id="StyleBoxTexture_ghshe"]
texture = ExtResource("2_vimvf")
axis_stretch_horizontal = 1
axis_stretch_vertical = 1
modulate_color = Color(0.6, 0.6, 0.6, 1)

[sub_resource type="StyleBoxTexture" id="StyleBoxTexture_fv2he"]
texture = ExtResource("2_vimvf")
axis_stretch_horizontal = 1
axis_stretch_vertical = 1
modulate_color = Color(0.6, 0.6, 0.6, 1)

[sub_resource type="StyleBoxTexture" id="StyleBoxTexture_5smuj"]
texture = ExtResource("2_vimvf")
axis_stretch_horizontal = 1
axis_stretch_vertical = 1
modulate_color = Color(0.6, 0.6, 0.6, 1)

[node name="Game" type="Node2D"]
script = ExtResource("1_84odl")

[node name="Background" type="ColorRect" parent="."]
z_index = -1
offset_right = 1152.0
offset_bottom = 648.0
color = Color(0, 0, 0, 1)

[node name="PlayAreaGridBackground" type="TextureRect" parent="Background"]
z_index = 1
layout_mode = 0
offset_left = 81.0
offset_right = 559.0
offset_bottom = 647.0
texture = ExtResource("2_vimvf")
stretch_mode = 1

[node name="Frame" type="NinePatchRect" parent="Background"]
layout_mode = 0
offset_left = 110.0
offset_top = 61.0
offset_right = 530.0
offset_bottom = 546.0
texture = ExtResource("1_gyfs4")
draw_center = false
region_rect = Rect2(-0.1139431, -0.04946804, 40.40973, 56.330612)
patch_margin_left = 4
patch_margin_top = 4
patch_margin_right = 4
patch_margin_bottom = 4
axis_stretch_horizontal = 2
axis_stretch_vertical = 1

[node name="Tiles" type="TileMapLayer" parent="."]
unique_name_in_owner = true
position = Vector2(304, 96)
tile_map_data = PackedByteArray("AAD5////AAACAAIAAAD5/wAAAAACAAIAAAD5/wEAAAACAAIAAAD5/wIAAAACAAIAAAD5/wQAAAACAAIAAAD5/wUAAAACAAIAAAD5/wYAAAACAAIAAAD5/wcAAAACAAIAAAD5/wkAAAACAAIAAAD5/woAAAACAAIAAAD5/wgAAAACAAIAAAAHAP//AAACAAIAAAAHAAAAAAACAAIAAAAHAAEAAAACAAIAAAAHAAIAAAACAAIAAAAHAAQAAAACAAIAAAAHAAUAAAACAAIAAAAHAAYAAAACAAIAAAAHAAcAAAACAAIAAAAHAAgAAAACAAIAAAAHAAkAAAACAAIAAAAHAAoAAAACAAIAAAAHAAsAAAACAAIAAAAHAAwAAAACAAIAAAAHAA0AAAACAAIAAAD5/wsAAAACAAIAAAD5/wwAAAACAAIAAAD5/w0AAAACAAIAAAD6/w4AAAABAAEAAAD7/w4AAAABAAEAAAD8/w4AAAABAAEAAAD9/w4AAAABAAEAAAD+/w4AAAABAAEAAAAAAA4AAAABAAEAAAABAA4AAAABAAEAAAACAA4AAAABAAEAAAADAA4AAAACAAIAAAAEAA4AAAABAAEAAAAFAA4AAAABAAEAAAAGAA4AAAABAAEAAAD5/w4AAAABAAIAAAAHAA4AAAAAAAMAAAAHAAMAAAABAAEAAAD//w4AAAABAAEAAAD5/wMAAAABAAEAAAA=")
tile_set = SubResource("TileSet_gyfs4")
script = ExtResource("4_7ycvg")

[node name="WaterSource" type="Node2D" parent="Tiles"]
position = Vector2(112, 470)

[node name="NewBlock" type="Node2D" parent="."]
position = Vector2(306, 84)
script = ExtResource("4_nfk4m")
metadata/_edit_group_ = true

[node name="Timer" type="Timer" parent="."]
unique_name_in_owner = true
process_callback = 0
wait_time = 0.75
autostart = true
script = ExtResource("7_ak604")

[node name="PieceQueue" type="NinePatchRect" parent="."]
unique_name_in_owner = true
offset_left = 611.0
offset_top = 45.0
offset_right = 1617.0
offset_bottom = 243.0
scale = Vector2(0.5, 0.5)
texture = ExtResource("1_gyfs4")
patch_margin_left = 4
patch_margin_top = 4
patch_margin_right = 4
patch_margin_bottom = 4
axis_stretch_horizontal = 1
axis_stretch_vertical = 1
script = ExtResource("6_7ycvg")

[node name="SFXVolume" type="NinePatchRect" parent="."]
offset_left = 610.0
offset_top = 164.0
offset_right = 1115.0
offset_bottom = 263.0
texture = ExtResource("1_gyfs4")
patch_margin_left = 4
patch_margin_top = 4
patch_margin_right = 4
patch_margin_bottom = 4

[node name="VBoxContainer" type="VBoxContainer" parent="SFXVolume"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -246.5
offset_top = -45.5
offset_right = 246.5
offset_bottom = 45.5
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/separation = 8
alignment = 1

[node name="Label" type="Label" parent="SFXVolume/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 32
text = "SFX volume"
horizontal_alignment = 1
vertical_alignment = 1

[node name="SFXSlider" type="HSlider" parent="SFXVolume/VBoxContainer"]
custom_minimum_size = Vector2(400, 0)
layout_mode = 2
size_flags_horizontal = 4
size_flags_vertical = 1
focus_mode = 0
theme_override_constants/center_grabber = 0
theme_override_constants/grabber_offset = 0
theme_override_constants/tick_offset = 0
theme_override_icons/grabber = ExtResource("10_ghshe")
theme_override_styles/grabber_area = SubResource("StyleBoxFlat_fv2he")
min_value = -48.0
max_value = 0.0
step = 6.0
ticks_on_borders = true
ticks_position = 3

[node name="MusicVolume" type="NinePatchRect" parent="."]
offset_left = 610.0
offset_top = 284.0
offset_right = 1115.0
offset_bottom = 414.0
texture = ExtResource("1_gyfs4")
patch_margin_left = 4
patch_margin_top = 4
patch_margin_right = 4
patch_margin_bottom = 4

[node name="VBoxContainer" type="VBoxContainer" parent="MusicVolume"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -246.5
offset_top = -64.0
offset_right = 246.5
offset_bottom = 62.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/separation = 8
alignment = 1

[node name="Label" type="Label" parent="MusicVolume/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 1
theme_override_font_sizes/font_size = 32
text = "Music volume"
horizontal_alignment = 1
vertical_alignment = 1

[node name="MusicSlider" type="HSlider" parent="MusicVolume/VBoxContainer"]
custom_minimum_size = Vector2(400, 0)
layout_mode = 2
size_flags_horizontal = 4
size_flags_vertical = 1
focus_mode = 0
theme_override_constants/center_grabber = 0
theme_override_constants/grabber_offset = 0
theme_override_constants/tick_offset = 0
theme_override_icons/grabber = ExtResource("10_ghshe")
theme_override_styles/grabber_area = SubResource("StyleBoxFlat_fv2he")
min_value = -48.0
max_value = 0.0
step = 6.0
ticks_on_borders = true
ticks_position = 3

[node name="GridContainer" type="GridContainer" parent="MusicVolume/VBoxContainer"]
layout_mode = 2
columns = 2

[node name="PreviousSong" type="Button" parent="MusicVolume/VBoxContainer/GridContainer"]
layout_mode = 2
size_flags_horizontal = 3
focus_mode = 0
theme_override_font_sizes/font_size = 13
theme_override_styles/normal = SubResource("StyleBoxEmpty_ghshe")
text = " ← Prev song"
alignment = 0

[node name="NextSong" type="Button" parent="MusicVolume/VBoxContainer/GridContainer"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
focus_mode = 0
theme_override_font_sizes/font_size = 13
theme_override_styles/normal = SubResource("StyleBoxEmpty_fv2he")
text = "Next song → "
alignment = 2

[node name="RestartEasy" type="NinePatchRect" parent="."]
offset_left = 610.0
offset_top = 435.0
offset_right = 854.0
offset_bottom = 541.0
texture = ExtResource("1_gyfs4")
patch_margin_left = 4
patch_margin_top = 4
patch_margin_right = 4
patch_margin_bottom = 4

[node name="RestartEasyButton" type="Button" parent="RestartEasy"]
layout_mode = 0
offset_left = 2.0
offset_top = 2.0
offset_right = 242.0
offset_bottom = 104.0
theme_override_styles/normal = SubResource("StyleBoxTexture_ghshe")
text = "Restart

Easy
single goal"

[node name="RestartNormal" type="NinePatchRect" parent="."]
offset_left = 868.0
offset_top = 435.0
offset_right = 1115.0
offset_bottom = 541.0
texture = ExtResource("1_gyfs4")
patch_margin_left = 4
patch_margin_top = 4
patch_margin_right = 4
patch_margin_bottom = 4

[node name="RestartNormalButton" type="Button" parent="RestartNormal"]
layout_mode = 0
offset_left = 2.0
offset_top = 2.0
offset_right = 245.0
offset_bottom = 104.0
theme_override_styles/normal = SubResource("StyleBoxTexture_fv2he")
text = "Restart 

Normal
both goals"

[node name="Credits" type="NinePatchRect" parent="."]
offset_left = 610.0
offset_top = 565.0
offset_right = 1115.0
offset_bottom = 605.0
texture = ExtResource("1_gyfs4")
patch_margin_left = 4
patch_margin_top = 4
patch_margin_right = 4
patch_margin_bottom = 4

[node name="PauseCreditsButton" type="Button" parent="Credits"]
layout_mode = 0
offset_left = 2.0
offset_top = 2.0
offset_right = 503.0
offset_bottom = 38.0
theme_override_styles/normal = SubResource("StyleBoxTexture_5smuj")
text = "Pause / Credits"

[node name="SFXManager" type="Node" parent="."]
script = ExtResource("6_nfk4m")
moved_left_snd = ExtResource("9_wr18j")
moved_right_snd = ExtResource("9_wr18j")
moved_down_snd = ExtResource("9_wr18j")
rotated_snd = ExtResource("9_wr18j")
landed_snd = ExtResource("8_7ycvg")

[node name="SFXPlayer1" type="AudioStreamPlayer" parent="SFXManager"]
max_polyphony = 4

[node name="SFXPlayer2" type="AudioStreamPlayer" parent="SFXManager"]

[node name="SFXPlayer3" type="AudioStreamPlayer" parent="SFXManager"]

[node name="MusicPlayer" type="AudioStreamPlayer" parent="."]
volume_db = -6.0
script = ExtResource("10_wr18j")
songs = Array[AudioStream]([ExtResource("11_6jybn"), ExtResource("12_84odl"), ExtResource("13_ak604"), ExtResource("14_vimvf"), ExtResource("15_ghshe"), ExtResource("16_fv2he"), ExtResource("17_5smuj"), ExtResource("18_y5ved"), ExtResource("19_kv3aw")])

[node name="PauseCreditsOverlay" type="CanvasLayer" parent="." groups=["Overlays"]]
visible = false

[node name="PanelContainer" type="PanelContainer" parent="PauseCreditsOverlay"]
anchors_preset = -1
anchor_left = 0.286
anchor_top = 0.469
anchor_right = 0.286
anchor_bottom = 0.469
offset_left = -211.47202
offset_top = -239.91202
offset_right = 197.52798
offset_bottom = 240.08798

[node name="Text" type="RichTextLabel" parent="PauseCreditsOverlay/PanelContainer"]
layout_mode = 2
bbcode_enabled = true
text = "[u][font_size=24]Made by[/font_size][/u]

Kelton & Lyco
for 
Godot Wild Jam #89

[u][font_size=24]Sound effects[/font_size][/u]

FilmCow Royalty Free Sound Effects Library

JSFXR sound generator

[u][font_size=24]Music[/font_size][/u]

Abstraction: FREE Music Loop Bundle

[u][font_size=24]Graphics[/font_size][/u]

OpenGameArt"
horizontal_alignment = 1
vertical_alignment = 1

[node name="GameOverOverlay" type="CanvasLayer" parent="." groups=["Overlays"]]
visible = false

[node name="PanelContainer" type="PanelContainer" parent="GameOverOverlay"]
anchors_preset = -1
anchor_left = 0.286
anchor_top = 0.469
anchor_right = 0.286
anchor_bottom = 0.469
offset_left = -211.47202
offset_top = -239.91202
offset_right = 197.52798
offset_bottom = 240.08798

[node name="Label" type="Label" parent="GameOverOverlay/PanelContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 32
text = "Game Over"
horizontal_alignment = 1
vertical_alignment = 1

[node name="VictoryOverlay" type="CanvasLayer" parent="." groups=["Overlays"]]
visible = false

[node name="PanelContainer" type="PanelContainer" parent="VictoryOverlay"]
anchors_preset = -1
anchor_left = 0.286
anchor_top = 0.469
anchor_right = 0.286
anchor_bottom = 0.469
offset_left = -210.47202
offset_top = -239.91202
offset_right = 198.52798
offset_bottom = 240.08798

[node name="Label" type="Label" parent="VictoryOverlay/PanelContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 40
text = "Victory"
horizontal_alignment = 1
vertical_alignment = 1

[connection signal="paused" from="." to="NewBlock" method="_on_game_paused"]
[connection signal="paused" from="." to="Timer" method="_on_game_paused"]
[connection signal="reset" from="." to="Tiles" method="_on_game_reset"]
[connection signal="reset" from="." to="NewBlock" method="_on_game_reset"]
[connection signal="reset" from="." to="Timer" method="_on_game_reset"]
[connection signal="reset" from="." to="PieceQueue" method="_on_game_reset"]
[connection signal="unpaused" from="." to="NewBlock" method="_on_game_unpaused"]
[connection signal="unpaused" from="." to="Timer" method="_on_game_unpaused"]
[connection signal="water_reached_goal" from="Tiles" to="." method="_on_tiles_water_reached_goal"]
[connection signal="block_landed" from="NewBlock" to="SFXManager" method="_on_new_block_block_landed"]
[connection signal="block_moved_down" from="NewBlock" to="SFXManager" method="_on_new_block_block_moved_down"]
[connection signal="block_moved_left" from="NewBlock" to="SFXManager" method="_on_new_block_block_moved_left"]
[connection signal="block_moved_right" from="NewBlock" to="SFXManager" method="_on_new_block_block_moved_right"]
[connection signal="block_rotated" from="NewBlock" to="SFXManager" method="_on_new_block_block_rotated"]
[connection signal="overflowed" from="NewBlock" to="." method="_on_new_block_overflowed"]
[connection signal="timeout" from="Timer" to="Tiles" method="_on_timer_timeout"]
[connection signal="timeout" from="Timer" to="NewBlock" method="_on_timer_timeout"]
[connection signal="value_changed" from="SFXVolume/VBoxContainer/SFXSlider" to="SFXManager" method="_on_sfx_slider_value_changed"]
[connection signal="value_changed" from="MusicVolume/VBoxContainer/MusicSlider" to="MusicPlayer" method="_on_music_slider_value_changed"]
[connection signal="pressed" from="MusicVolume/VBoxContainer/GridContainer/PreviousSong" to="MusicPlayer" method="_on_previous_song_pressed"]
[connection signal="pressed" from="MusicVolume/VBoxContainer/GridContainer/NextSong" to="MusicPlayer" method="_on_next_song_pressed"]
[connection signal="pressed" from="RestartEasy/RestartEasyButton" to="." method="_on_restart_easy_button_pressed"]
[connection signal="pressed" from="RestartNormal/RestartNormalButton" to="." method="_on_restart_normal_button_pressed"]
[connection signal="pressed" from="Credits/PauseCreditsButton" to="." method="_on_pause_credits_button_pressed"]
[connection signal="finished" from="MusicPlayer" to="MusicPlayer" method="_on_finished"]
